# 一：promise

### 课时1：函数应用

#### 高阶函数：

1. 一个函数的参数 是一个函数。-（类似于回调函数）
2. 一个函数返回一个函数。-（类似于拆分函数）

以上两种满足一个就是高阶函数

#### 函数的before:

（希望将核心的逻辑提取出来，在外面增加功能----重写原型上的方法，因为本来并不存在before方法，而且希望before方法得到复用）

 

```js
//重写数组原型上的方法
Function.prototype.before = function(beforeFn){
    return (...args)=>{//剩余运算符
        beforeFn();
        this(...args);//箭头函数中没有this指向，也没有arguments，所有调用this会向上级作用域查找。
    }
}//重写了一个函数原型上的before函数，调用before函数，相当于先调用传入的参数，然后调用 调用了before函数的函数本身
const say = (...args)=>{
    console.log('说话',args);
}

const newSay = say.before(()=>{
    console.log('您好');
})

const newSay1 = say.before(()=>{
    console.log('天气很好')
})

newSay(1,2,3);
newSay1();
```

#### transcation--事务：

事务 开始的时候做某件事 结束的时候再做某件事

 ```js
const perform = (anyMethod, wrappers) => {
    wrappers.forEach(wrap => {
        wrap.initialize();
    });
    anyMethod();
    wrappers.forEach(wrap => {
        wrap.close();
    })
}
perform(() => {
    console.log('说话')
}, [{
        //wrapper1
        initialize() {
            console.log('您好1')
        },
        close() {
            console.log('再见1')
        }
    },
    {
        //wrapper2
        initialize() {
            console.log('您好2')
        },
        close() {
            console.log('再见2')
        }
    }
])
 ```

#### 柯理化函数curry：

将一个大函数拆分成多个小函数（）具体的函数。

柯理化函数也是高阶函数

**如何实现函数的柯理化？**

```js
const add = (a,b,c,d,e)=>{
    return a+b+c+d+e
}
//将add函数柯理化怎么实现？
const curring = (fn,arr=[])=>{
    let len = fn.length;
    return (...args)=>{
        arr = arr.concat(args);
        if(arr.length<len){
            return curring(fn,arr)
        }
        return fn(...arr)
    }
}


let r = curring(add)(1)(2,3)(4)(5);
console.log(r)
```







有一个函数checkType 检测数据类型的函数，需要传递两个函数，一个是类型一个是内容：

![1571931232633](C:\Users\Huawei\AppData\Roaming\Typora\typora-user-images\1571931232633.png)





将这个函数手动柯理化，效果如下：

![1571931163879](C:\Users\Huawei\AppData\Roaming\Typora\typora-user-images\1571931163879.png)



有了通用的curring 自动柯理化之后效果如下：

![1571931147751](C:\Users\Huawei\AppData\Roaming\Typora\typora-user-images\1571931147751.png)







